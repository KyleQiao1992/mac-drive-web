{"remainingRequest":"/Users/mttest/Profile/mac-drive-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mttest/Profile/mac-drive-web/src/components/CodeReview.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mttest/Profile/mac-drive-web/src/components/CodeReview.vue","mtime":1701827905859},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIHZ1ZS1jb2RlbWlycm9yIOebuOWFs++8jOWumOe9keWcsOWdgO+8mmh0dHBzOi8vZ2l0aHViLmNvbS9zdXJtb24tY2hpbmEvdnVlLWNvZGVtaXJyb3IKaW1wb3J0IHsgY29kZW1pcnJvciB9IGZyb20gInZ1ZS1jb2RlbWlycm9yIjsKaW1wb3J0ICJjb2RlbWlycm9yL2xpYi9jb2RlbWlycm9yLmNzcyI7CmltcG9ydCAiY29kZW1pcnJvci9rZXltYXAvc3VibGltZSI7CmltcG9ydCAiY29kZW1pcnJvci90aGVtZS9kcmFjdWxhLmNzcyI7CmltcG9ydCAiY29kZW1pcnJvci9tb2RlL3Z1ZS92dWUuanMiOwppbXBvcnQgImNvZGVtaXJyb3IvYWRkb24vc2VsZWN0aW9uL2FjdGl2ZS1saW5lIjsgLy/lhYnmoIfooYzog4zmma/pq5jkuq7vvIzphY3nva7ph4zpnaLkuZ/pnIDopoFzdHlsZUFjdGl2ZUxpbmXorr7nva7kuLp0cnVlCgovLyDmlofku7bkv67mlLnnm7jlhbMKaW1wb3J0IHsgZ2V0RmlsZVByZXZpZXcgfSBmcm9tICJAL3JlcXVlc3QvZmlsZSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkNvZGVQcmV2aWV3IiwKICBjb21wb25lbnRzOiB7CiAgICBjb2RlbWlycm9yCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9udFNpemVMaXN0OiBbMTIsIDE0LCAxNiwgMTgsIDIwLCAyMiwgMjQsIDI2LCAyOCwgMzBdLAogICAgICBvcmlnaW5hbENvZGVUZXh0OiAiIiwgLy8g5Luj56CB5Y6f5pys55qE5paH5pysCiAgICAgIGNvZGVNaXJyb3JUZXh0OiAiIiwgLy8g5Luj56CB5a6e5pe25L+u5pS555qE5paH5pysCiAgICAgIGNvZGVNaXJyb3JMb2FkaW5nOiBmYWxzZSwgLy8g5Luj56CB5YaF5a655piv5ZCm5Yqg6L295LitCiAgICAgIC8vIGNvZGVtaXJyb3Ig6YWN572u6aG577yM5Y+C6ICDIGh0dHBzOi8vY29kZW1pcnJvci5uZXQvZG9jL21hbnVhbC5odG1sI2NvbmZpZwogICAgICBjb2RlTWlycm9yT3B0aW9uczogewogICAgICAgIHRhYlNpemU6IDQsIC8vICDliLbooajnrKbnmoTlrr3luqbjgILpu5jorqTkuLogNOOAggogICAgICAgIG1vZGU6ICJ0ZXh0L2h0bWwiLCAvLyAg6Kej5p6Q5b2T5YmN5Luj56CB55qE5qih5byP77yM5Y+C6ICDIGh0dHBzOi8vY29kZW1pcnJvci5uZXQvbW9kZS8g5q+P56eN6K+t6KiA55qE56S65L6L6aG16Z2i55qE5bqV6YOo6YO95pyJ5a+55bqU55qEIE1JTUUg57G75Z6L77yM5aaC5p6c5b2T5YmN5paH5Lu25ZCO57yA5rKh5pyJ5Yy56YWN55qE6K+t6KiA77yM5oyJ54WnIGh0bWwg5p2l6Kej5p6QCiAgICAgICAgdGhlbWU6ICJkZWZhdWx0IiwgLy8gIOS7o+eggemrmOS6ruS4u+mimOiJsu+8jOWFtuS7luS4u+mimOiJsuWPguiAgyBodHRwczovL2NvZGVtaXJyb3IubmV0L3RoZW1lLwogICAgICAgIHJlYWRPbmx5OiBmYWxzZSwgLy8gIHRydWUg5Y+q6K+75LiN5Y+v57yW6L6RIHwgZmFsc2Ug5Y+v57yW6L6RIHwgIm5vY3Vyc29yIu+8iOiAjOS4jeaYr+eugOWNleeahCB0cnVlIO+8ie+8jOS4jeWFgeiuuOe8lui+keWZqOiBmueEpuOAggogICAgICAgIGxpbmVOdW1iZXJzOiB0cnVlLCAvLyAg5piv5ZCm5Zyo57yW6L6R5Zmo5bem5L6n5pi+56S66KGM5Y+3CiAgICAgICAgbGluZTogdHJ1ZSwKICAgICAgICBhdXRvQ2xvc2VCcmFja2V0czogdHJ1ZSwgLy8gIOiHquWKqOihpeWFqOaLrOWPtwogICAgICAgIGZvbGRHdXR0ZXI6IHRydWUsIC8vICDliJvlu7rluKbmnInmjIfnpLrlj6/mipjlj6DlnZfnmoTmoIforrDnmoToo4XorqLnur8KICAgICAgICBsaW5lV3JhcHBpbmc6IHRydWUsIC8vICDplb/ooYzlpITnkIbvvJpmYWxzZSDmu5rliqggfCB0cnVlIOaNouihjAogICAgICAgIC8vIOmineWklueahOijheiuoue6vwogICAgICAgIGd1dHRlcnM6IFsKICAgICAgICAgICJDb2RlTWlycm9yLWxpbmVudW1iZXJzIiwKICAgICAgICAgICJDb2RlTWlycm9yLWZvbGRndXR0ZXIiLAogICAgICAgICAgIkNvZGVNaXJyb3ItbGludC1tYXJrZXJzIgogICAgICAgIF0KICAgICAgfSwKICAgICAgaXNTaG93OiB0cnVlLCAvLyAgY29kZW1pcnJvciDmmK/lkKblsZXnpLoKICAgICAgLy8gY29kZW1pcnJvciDoh6rlrprkuYnphY3nva7pobkKICAgICAgY29kZU1pcnJvckN1c3RvbU9wdGlvbnM6IHsKICAgICAgICBmb250U2l6ZTogMTQKICAgICAgfQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDmmK/lkKbkv67mlLkKICAgIGlzTW9kaWZ5KCkgewogICAgICByZXR1cm4gdGhpcy5vcmlnaW5hbENvZGVUZXh0ICE9PSB0aGlzLmNvZGVNaXJyb3JUZXh0OwogICAgfSwKICAgIC8vIOWbvueJh+afpeeci+e7hOS7tuaYr+WQpuaYvuekugogICAgVmlzaWJsZSgpIHsKICAgICAgaWYgKHRoaXMuJHN0b3JlLnN0YXRlLmNvZGVSZXZpZXcuY29kZVJldmlld1Zpc2libGUpIHsKICAgICAgICB0aGlzLmdldENvZGVUZXh0KCk7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5dXAiLCBlID0+IHsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgICAgICAgICB0aGlzLmNsb3NlQ29kZVByZXZpZXcoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9LAogICAgLy8g5Zu+54mH5YiX6KGoCiAgICBjb2RlUmV2aWV3TmFtZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmNvZGVSZXZpZXcuZmlsZW5hbWU7CiAgICB9CiAgICAvLyBhY3RpdmVGaWxlSUQoKSB7CiAgICAvLyAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLmNvZGVSZXZpZXcuY29kZVJldmlld0xpc3QpOwogICAgLy8gICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuY29kZVJldmlldy5maWxlSWQ7CiAgICAvLyB9CiAgfSwKICB3YXRjaDogewogICAgLy8g55uR5ZCs5Luj56CB5p+l55yL57uE5Lu2IOaYvumakOeKtuaAgeWPmOWMlgogICAgdmlzaWJsZSh2YWwpIHsKICAgICAgaWYgKHZhbCkgewogICAgICAgIC8vIGNvZGVtaXJyb3Ig6Kej5p6Q5qih5byP6K6+572uCiAgICAgICAgdGhpcy5jb2RlTWlycm9yT3B0aW9ucy5yZWFkT25seSA9IGZhbHNlOyAvLyAg6K6+572u57yW6L6R5Zmo5piv5ZCm5Y+q6K+7CiAgICAgICAgLy8gY29kZW1pcnJvciDkuLvpopjojrflj5YKICAgICAgICB0aGlzLmNvZGVNaXJyb3JPcHRpb25zLnRoZW1lID0KICAgICAgICAgIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJmaWxlX2NvZGVtaXJyb3JfdGhlbWUiKSB8fCAiZGVmYXVsdCI7CiAgICAgICAgdGhpcy5nZXRDb2RlVGV4dCgpOwogICAgICAgIC8vIOa3u+WKoOmUruebmCBFc2Mg5LqL5Lu2CiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigia2V5dXAiLCBlID0+IHsKICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcpIHsKICAgICAgICAgICAgICB0aGlzLmNsb3NlQ29kZVByZXZpZXcoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigia2V5dXAiLCBlID0+IHsKICAgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDI3KSB7CiAgICAgICAgICAgIHRoaXMuY2xvc2VDb2RlUHJldmlldygpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgLy8g55uR5ZCs5Li76aKY5Y+Y5YyWCiAgICAiY29kZU1pcnJvck9wdGlvbnMudGhlbWUiKHZhbCkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiZmlsZV9jb2RlbWlycm9yX3RoZW1lIiwgdmFsKTsKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIC8qKgogICAgICog6I635Y+W5Luj56CB5paH5pys5YaF5a65CiAgICAgKi8KICAgIGdldENvZGVUZXh0KCkgewogICAgICB0aGlzLmNvZGVNaXJyb3JMb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0RmlsZVByZXZpZXcoewogICAgICAgIHVzZXJGaWxlSWQ6IHRoaXMuJHN0b3JlLnN0YXRlLmNvZGVSZXZpZXcuZmlsZUlkCiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLmNvZGVNaXJyb3JMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5vcmlnaW5hbENvZGVUZXh0ID0KICAgICAgICAgIHR5cGVvZiByZXMgPT09ICJvYmplY3QiID8gSlNPTi5zdHJpbmdpZnkocmVzKSA6IHJlczsKICAgICAgICB0aGlzLmNvZGVNaXJyb3JUZXh0ID0gdGhpcy5vcmlnaW5hbENvZGVUZXh0OwogICAgICB9KTsKICAgIH0sCiAgICAvKioKICAgICAqIOS/ruaUueS7o+eggeaWh+acrOWGheWuuQogICAgICovCiAgICAvLyBoYW5kbGVNb2RpZnlGaWxlQ29udGVudCgpIHsKICAgIC8vICAgLy8g5aaC5p6c5rKh5pyJ5L+u5pS577yM5oiW5b2T5YmN5Li65Y+q6K+754q25oCBCiAgICAvLyAgIGlmICghdGhpcy5pc01vZGlmeSB8fCB0aGlzLmNvZGVNaXJyb3JPcHRpb25zLnJlYWRPbmx5KSB7CiAgICAvLyAgICAgcmV0dXJuIGZhbHNlOwogICAgLy8gICB9CiAgICAvLyAgIHRoaXMuY29kZU1pcnJvckxvYWRpbmcgPSB0cnVlOwogICAgLy8gICBtb2RpZnlGaWxlQ29udGVudCh7CiAgICAvLyAgICAgdXNlckZpbGVJZDogdGhpcy5maWxlSW5mby51c2VyRmlsZUlkLAogICAgLy8gICAgIGZpbGVDb250ZW50OiB0aGlzLmNvZGVNaXJyb3JUZXh0CiAgICAvLyAgIH0pCiAgICAvLyAgICAgLnRoZW4ocmVzID0+IHsKICAgIC8vICAgICAgIHRoaXMuY29kZU1pcnJvckxvYWRpbmcgPSBmYWxzZTsKICAgIC8vICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgLy8gICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuW3suS/neWtmCIpOwogICAgLy8gICAgICAgICB0aGlzLmdldENvZGVUZXh0KCk7CiAgICAvLyAgICAgICB9IGVsc2UgewogICAgLy8gICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tZXNzYWdlKTsKICAgIC8vICAgICAgIH0KICAgIC8vICAgICB9KQogICAgLy8gICAgIC5jYXRjaChlcnIgPT4gewogICAgLy8gICAgICAgdGhpcy5jb2RlTWlycm9yTG9hZGluZyA9IGZhbHNlOwogICAgLy8gICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihlcnIubWVzc2FnZSk7CiAgICAvLyAgICAgfSk7CiAgICAvLyB9LAogICAgLyoqCiAgICAgKiBjb2RlbWlycm9yIOmFjee9rumhueaUueWPmOaXtuinpuWPkQogICAgICovCiAgICBoYW5kbGVDaGFuZ2VDb2RlTWlycm9yT3B0aW9uKCkgewogICAgICB0aGlzLmlzU2hvdyA9IGZhbHNlOwogICAgICB0aGlzLmlzU2hvdyA9IHRydWU7CiAgICB9LAogICAgLyoqCiAgICAgKiDlhbPpl63ku6PnoIHpooTop4gKICAgICAqLwogICAgY2xvc2VDb2RlUHJldmlldygpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRDb2RlUmV2aWV3RGF0YSIsIHsgY29kZVJldmlld1Zpc2libGU6IGZhbHNlIH0pOwogICAgICAvLyB0aGlzLmNhbGxiYWNrKCJjYW5jZWwiKTsKICAgIH0sCiAgICAvKioKICAgICAqIOS4i+i9vQogICAgICovCiAgICBkb3dUeHQoKSB7CiAgICAgIHdpbmRvdy5vcGVuKAogICAgICAgIHRoaXMuZ2V0RG93bmxvYWRGaWxlKHRoaXMuJHN0b3JlLnN0YXRlLmNvZGVSZXZpZXcuZmlsZUlkKSwKICAgICAgICAiX2JsYW5rIgogICAgICApOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["CodeReview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoFA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"CodeReview.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <transition name=\"el-fade-in-linear el-fade-in\">\n    <div class=\"code-preview-wrapper\" v-show=\"Visible\">\n      <!-- 顶部信息栏 & 工具栏 -->\n      <div class=\"tip-wrapper\" v-if=\"Visible\">\n        <div class=\"name\" :title=\"codeReviewName\">\n          {{ codeReviewName }}\n          <span class=\"un-save\" v-show=\"isModify && !codeMirrorOptions.readOnly\"\n            >（未保存）</span\n          >\n        </div>\n\n        <div class=\"tool-wrapper\">\n          <a class=\"item download-link\" >\n            <i class=\"el-icon-download\"\n               @click=\"dowTxt()\"\n               title=\"下载\"></i>\n          </a>\n          <i\n            class=\"item el-icon-close\"\n            title=\"关闭预览\"\n            @click=\"closeCodePreview()\"\n            style=\"padding-right: 70px\"\n          ></i>\n        </div>\n      </div>\n      <!-- 代码编辑区域 -->\n      <div class=\"code-editor-wrapper\">\n        <div class=\"operate-wrapper\">\n          <i\n            class=\"save-icon iconfont icon-baocun\"\n            title=\"保存（ctrl+s）\"\n            v-show=\"isModify && !codeMirrorOptions.readOnly\"\n          ></i>\n          <el-form\n            class=\"editor-set-form\"\n            :model=\"codeMirrorOptions\"\n            :inline=\"true\"\n            size=\"small\"\n            label-position=\"right\"\n            label-suffix=\":\"\n          >\n            <el-form-item label-width=\"0px\" class=\"line-wrapper\">\n              <el-checkbox\n                v-model=\"codeMirrorOptions.lineWrapping\"\n                @change=\"handleChangeCodeMirrorOption\"\n                >自动换行</el-checkbox\n              >\n            </el-form-item>\n            <el-form-item label-width=\"60px\" label=\"字号\" class=\"font-size\">\n              <el-select v-model=\"codeMirrorCustomOptions.fontSize\" filterable>\n                <el-option\n                  v-for=\"(item, index) in fontSizeList\"\n                  :key=\"index\"\n                  :value=\"item\"\n                  :label=\"`${item} px`\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n            <el-form-item label=\"主题\" label-width=\"60px\" class=\"theme\">\n              <el-select\n                v-model=\"codeMirrorOptions.theme\"\n                filterable\n                @change=\"handleChangeCodeMirrorOption\"\n              >\n              </el-select>\n            </el-form-item>\n          </el-form>\n        </div>\n        <codemirror\n          class=\"code-editor\"\n          ref=\"codemirrorRef\"\n          v-model=\"codeMirrorText\"\n          :options=\"codeMirrorOptions\"\n          v-loading=\"codeMirrorLoading\"\n          v-if=\"isShow\"\n          :style=\"`font-size: ${codeMirrorCustomOptions.fontSize}px;`\"\n        />\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\n// vue-codemirror 相关，官网地址：https://github.com/surmon-china/vue-codemirror\nimport { codemirror } from \"vue-codemirror\";\nimport \"codemirror/lib/codemirror.css\";\nimport \"codemirror/keymap/sublime\";\nimport \"codemirror/theme/dracula.css\";\nimport \"codemirror/mode/vue/vue.js\";\nimport \"codemirror/addon/selection/active-line\"; //光标行背景高亮，配置里面也需要styleActiveLine设置为true\n\n// 文件修改相关\nimport { getFilePreview } from \"@/request/file\";\n\nexport default {\n  name: \"CodePreview\",\n  components: {\n    codemirror\n  },\n  data() {\n    return {\n      fontSizeList: [12, 14, 16, 18, 20, 22, 24, 26, 28, 30],\n      originalCodeText: \"\", // 代码原本的文本\n      codeMirrorText: \"\", // 代码实时修改的文本\n      codeMirrorLoading: false, // 代码内容是否加载中\n      // codemirror 配置项，参考 https://codemirror.net/doc/manual.html#config\n      codeMirrorOptions: {\n        tabSize: 4, //  制表符的宽度。默认为 4。\n        mode: \"text/html\", //  解析当前代码的模式，参考 https://codemirror.net/mode/ 每种语言的示例页面的底部都有对应的 MIME 类型，如果当前文件后缀没有匹配的语言，按照 html 来解析\n        theme: \"default\", //  代码高亮主题色，其他主题色参考 https://codemirror.net/theme/\n        readOnly: false, //  true 只读不可编辑 | false 可编辑 | \"nocursor\"（而不是简单的 true ），不允许编辑器聚焦。\n        lineNumbers: true, //  是否在编辑器左侧显示行号\n        line: true,\n        autoCloseBrackets: true, //  自动补全括号\n        foldGutter: true, //  创建带有指示可折叠块的标记的装订线\n        lineWrapping: true, //  长行处理：false 滚动 | true 换行\n        // 额外的装订线\n        gutters: [\n          \"CodeMirror-linenumbers\",\n          \"CodeMirror-foldgutter\",\n          \"CodeMirror-lint-markers\"\n        ]\n      },\n      isShow: true, //  codemirror 是否展示\n      // codemirror 自定义配置项\n      codeMirrorCustomOptions: {\n        fontSize: 14\n      }\n    };\n  },\n  computed: {\n    // 是否修改\n    isModify() {\n      return this.originalCodeText !== this.codeMirrorText;\n    },\n    // 图片查看组件是否显示\n    Visible() {\n      if (this.$store.state.codeReview.codeReviewVisible) {\n        this.getCodeText();\n        this.$nextTick(() => {\n          document.addEventListener(\"keyup\", e => {\n            if (e.keyCode === 27) {\n              this.closeCodePreview();\n            }\n          });\n        });\n        return true;\n      } else {\n        return false;\n      }\n    },\n    // 图片列表\n    codeReviewName() {\n      return this.$store.state.codeReview.filename;\n    }\n    // activeFileID() {\n    //   // console.log(this.$store.state.codeReview.codeReviewList);\n    //   return this.$store.state.codeReview.fileId;\n    // }\n  },\n  watch: {\n    // 监听代码查看组件 显隐状态变化\n    visible(val) {\n      if (val) {\n        // codemirror 解析模式设置\n        this.codeMirrorOptions.readOnly = false; //  设置编辑器是否只读\n        // codemirror 主题获取\n        this.codeMirrorOptions.theme =\n          localStorage.getItem(\"file_codemirror_theme\") || \"default\";\n        this.getCodeText();\n        // 添加键盘 Esc 事件\n        this.$nextTick(() => {\n          document.addEventListener(\"keyup\", e => {\n            if (e.keyCode === 27) {\n              this.closeCodePreview();\n            }\n          });\n        });\n      } else {\n        document.removeEventListener(\"keyup\", e => {\n          if (e.keyCode === 27) {\n            this.closeCodePreview();\n          }\n        });\n      }\n    },\n    // 监听主题变化\n    \"codeMirrorOptions.theme\"(val) {\n      localStorage.setItem(\"file_codemirror_theme\", val);\n    }\n  },\n  methods: {\n    /**\n     * 获取代码文本内容\n     */\n    getCodeText() {\n      this.codeMirrorLoading = true;\n      getFilePreview({\n        userFileId: this.$store.state.codeReview.fileId\n      }).then(res => {\n        this.codeMirrorLoading = false;\n        this.originalCodeText =\n          typeof res === \"object\" ? JSON.stringify(res) : res;\n        this.codeMirrorText = this.originalCodeText;\n      });\n    },\n    /**\n     * 修改代码文本内容\n     */\n    // handleModifyFileContent() {\n    //   // 如果没有修改，或当前为只读状态\n    //   if (!this.isModify || this.codeMirrorOptions.readOnly) {\n    //     return false;\n    //   }\n    //   this.codeMirrorLoading = true;\n    //   modifyFileContent({\n    //     userFileId: this.fileInfo.userFileId,\n    //     fileContent: this.codeMirrorText\n    //   })\n    //     .then(res => {\n    //       this.codeMirrorLoading = false;\n    //       if (res.success) {\n    //         this.$message.success(\"已保存\");\n    //         this.getCodeText();\n    //       } else {\n    //         this.$message.error(res.message);\n    //       }\n    //     })\n    //     .catch(err => {\n    //       this.codeMirrorLoading = false;\n    //       this.$message.error(err.message);\n    //     });\n    // },\n    /**\n     * codemirror 配置项改变时触发\n     */\n    handleChangeCodeMirrorOption() {\n      this.isShow = false;\n      this.isShow = true;\n    },\n    /**\n     * 关闭代码预览\n     */\n    closeCodePreview() {\n      this.$store.commit(\"setCodeReviewData\", { codeReviewVisible: false });\n      // this.callback(\"cancel\");\n    },\n    /**\n     * 下载\n     */\n    dowTxt() {\n      window.open(\n        this.getDownloadFile(this.$store.state.codeReview.fileId),\n        \"_blank\"\n      );\n    }\n  }\n};\n</script>\n\n<style lang=\"stylus\" scoped>\n@import \"../assets/style/mixins.styl\"\n@import \"../assets/style/varibles.styl\"\n\n.code-preview-wrapper {\n  position: fixed;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  overflow: auto;\n  width: 100%;\n  height: 100vh;\n  z-index: 2;\n  display: flex;\n  align-items: center;\n  animation: imgPreviewAnimation 0.3s;\n  -webkit-animation: imgPreviewAnimation 0.3s; /* Safari and Chrome */\n  animation-iteration-count: 0.3;\n  -webkit-animation-iteration-count: 0.3;\n  animation-fill-mode: forwards;\n  -webkit-animation-fill-mode: forwards; /* Safari 和 Chrome */\n  @keyframes imgPreviewAnimation {\n    0% {\n      background: transparent;\n    }\n    100% {\n      background: rgba(0, 0, 0, 0.8);\n    }\n  }\n  @keyframes imgPreviewAnimation {\n    0% {\n      background: transparent;\n    }\n    100% {\n      background: rgba(0, 0, 0, 0.8);\n    }\n  }\n  .tip-wrapper {\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 2;\n    background: rgba(0, 0, 0, 0.5);\n    padding: 0 48px;\n    width: 100%;\n    height: 48px;\n    line-height: 48px;\n    color: #fff;\n    font-size: 16px;\n    display: flex;\n    justify-content: space-between;\n    .name {\n      flex: 1;\n      padding-right: 16px;\n      text-align: left;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n      .un-save {\n        color: $Warning;\n        font-size: 14px;\n      }\n    }\n    .tool-wrapper {\n      flex: 1;\n      display: flex;\n      justify-content: flex-end;\n      .item {\n        margin-left: 16px;\n        height: 48px;\n        line-height: 48px;\n        cursor: pointer;\n        &:hover {\n          opacity: 0.7;\n        }\n      }\n      .download-link {\n        color: inherit;\n        font-size: 18px;\n      }\n      .text-wrapper {\n        .text {\n          margin-right: 8px;\n        }\n      }\n    }\n  }\n\n  .code-editor-wrapper {\n    margin: 56px auto 0 auto;\n    width: 90vw;\n    height: calc(100vh - 80px);\n    .operate-wrapper {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      border-radius: 8px 8px 0 0;\n      border-bottom: 1px solid $BorderBase;\n      padding: 8px 16px;\n      background: #fff;\n      .save-icon {\n        font-size: 20px;\n        cursor: pointer;\n        color: $Info;\n        font-weight: 550;\n        &:hover {\n          opacity: 0.5;\n        }\n      }\n      .editor-set-form {\n        flex: 1;\n        text-align: right;\n        >>> .el-form-item {\n          margin-bottom: 0;\n          &.font-size {\n            .el-form-item__content {\n              .el-select {\n                width: 96px;\n              }\n            }\n          }\n          &.lanaguage {\n            .el-form-item__content {\n              .el-select {\n                width: 120px;\n              }\n            }\n          }\n          &.theme {\n            .el-form-item__content {\n              .el-select {\n                width: 190px;\n              }\n            }\n          }\n        }\n      }\n    }\n    .code-editor {\n      height: calc(100vh - 129px);\n      >>> .CodeMirror {\n        border-radius: 0 0 8px 8px;\n        height: inherit;\n        font-size: inherit;\n        * {\n          font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace !important;\n        }\n        .CodeMirror-vscrollbar,\n        .CodeMirror-hscrollbar {\n          display: none !important;\n        }\n        .CodeMirror-scroll {\n          width: 100%;\n          padding: 8px 0 0 0;\n          line-height: 1.5;\n          font-size: inherit;\n          setScrollbar(12px, transparent, #C0C4CC);\n        }\n      }\n    }\n  }\n\n}\n</style>\n"]}]}