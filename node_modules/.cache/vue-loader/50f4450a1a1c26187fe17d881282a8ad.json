{"remainingRequest":"/Users/mttest/Profile/mac-drive-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mttest/Profile/mac-drive-web/src/views/components/FileUploader.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mttest/Profile/mac-drive-web/src/views/components/FileUploader.vue","mtime":1703323435140},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mttest/Profile/mac-drive-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBTcGFya01ENSBmcm9tICJzcGFyay1tZDUiOwppbXBvcnQgeyBnZXRNdWx0aXBhcnRVcGxvYWQsIGdldFVwRmlsZSB9IGZyb20gIkAvcmVxdWVzdC9maWxlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRmlsZVVwbG9hZGVyIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgb3B0aW9uczogewogICAgICAgIC8vIFRoZSB0YXJnZXQgdXBsb2FkIFVSTCwgd2hpY2ggY2FuIGJlIGEgc3RyaW5nIG9yIGEgZnVuY3Rpb24uIElmIGl0J3MgYSBmdW5jdGlvbiwgaXQgd2lsbCBiZSBwYXNzZWQgd2l0aCBVcGxvYWRlci5GaWxlIGluc3RhbmNlLAogICAgICAgIC8vIGN1cnJlbnQgY2h1bmsgVXBsb2FkZXIuQ2h1bmssIGFuZCB3aGV0aGVyIGl0IGlzIGluIHRlc3QgbW9kZS4gVGhlIGRlZmF1bHQgdmFsdWUgaXMgJy8nLgogICAgICAgIHRhcmdldDogZnVuY3Rpb24oZmlsZSwgY2h1bmtGaWxlLCBtb2RlKSB7CiAgICAgICAgICAvLyBFbnRlcmluZyB0aGlzIG1ldGhvZCBiZWZvcmUgZWFjaCBjaHVuayB1cGxvYWQKICAgICAgICAgIGNvbnNvbGUubG9nKCJFbnRlcmluZyB0YXJnZXQiKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJGaWxlIG5hbWU6ICIgKyBmaWxlLm5hbWUpOwogICAgICAgICAgY29uc29sZS5sb2coIkN1cnJlbnQgY2h1bmsgc2VxdWVuY2UgbnVtYmVyOiAiICsgY2h1bmtGaWxlLm9mZnNldCk7CiAgICAgICAgICBjb25zb2xlLmxvZygiUmV0cmlldmVkIGNodW5rIHVwbG9hZCBVUkw6Iik7CiAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlLmNodW5rVXJsRGF0YSk7CiAgICAgICAgICBjb25zdCBrZXkgPSAiY2h1bmtfIiArIGNodW5rRmlsZS5vZmZzZXQ7IC8vIEtleSBmb3IgcmV0cmlldmluZyBjaHVuayBsaW5rIFVSTAogICAgICAgICAgcmV0dXJuIGZpbGUuY2h1bmtVcmxEYXRhW2tleV07CiAgICAgICAgfSwKICAgICAgICAvLyBTZW5kcyBhIEdFVCByZXF1ZXN0IHRvIHRoZSBzZXJ2ZXIgZm9yIGVhY2ggY2h1bmsgdG8gY2hlY2sgaWYgaXQgYWxyZWFkeSBleGlzdHMuIElmIGltcGxlbWVudGVkIG9uIHRoZSBzZXJ2ZXIgc2lkZSwKICAgICAgICAvLyB0aGlzIHdpbGwgYWxsb3cgY29udGludWluZyB1cGxvYWRzIGFmdGVyIGEgYnJvd3NlciBjcmFzaCBvciBldmVuIGNvbXB1dGVyIHJlc3RhcnQuIChEZWZhdWx0OiB0cnVlKQogICAgICAgIHRlc3RDaHVua3M6IHRydWUsCiAgICAgICAgLy8gQ2h1bmtzIGFyZSBkaXZpZGVkIGFjY29yZGluZyB0byB0aGlzIHZhbHVlLiBUaGUgc2l6ZSBvZiB0aGUgbGFzdCBjaHVuayB3aWxsIGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB0aGlzIHZhbHVlLCBidXQgbGVzcyB0aGFuIHR3aWNlIHRoaXMgdmFsdWUuCiAgICAgICAgLy8gU2VlIHRoaXMgSXNzdWUgIzUxLCBkZWZhdWx0IDEqMTAyNCoxMDI0LgogICAgICAgIGNodW5rU2l6ZTogNSAqIDEwMjQgKiAxMDI0LAogICAgICAgIC8vIEZvcmNlcyBhbGwgY2h1bmtzIHRvIGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjaHVua1NpemUuIE90aGVyd2lzZSwgdGhlIGxhc3QgY2h1bmsgd2lsbCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gY2h1bmtTaXplLiAoRGVmYXVsdDogZmFsc2UpCiAgICAgICAgZm9yY2VDaHVua1NpemU6IHRydWUsCiAgICAgICAgLy8gQWRkaXRpb25hbCBwYXJhbWV0ZXJzIGluY2x1ZGVkIGluIG11bHRpcGFydCBQT1NUIHdpdGggZGF0YS4gVGhpcyBjYW4gYmUgYW4gb2JqZWN0IG9yIGEgZnVuY3Rpb24uIElmIGl0IGlzIGEgZnVuY3Rpb24sCiAgICAgICAgLy8gaXQgd2lsbCBiZSBwYXNzZWQgYW4gVXBsb2FkZXIuRmlsZSwgYW4gVXBsb2FkZXIuQ2h1bmsgb2JqZWN0LCBhbmQgYW4gaXNUZXN0IGJvb2xlYW4gdmFsdWUgKGRlZmF1bHQgdmFsdWUge33vvJopCiAgICAgICAgcXVlcnk6IGZ1bmN0aW9uKGZpbGUsIGNodW5rRmlsZSwgbW9kZSkgewogICAgICAgICAgY29uc3QgZGF0YSA9IHsgcGFydE51bWJlcjogY2h1bmtGaWxlLm9mZnNldCArIDEgfTsKICAgICAgICAgIHJldHVybiBkYXRhOwogICAgICAgIH0sCiAgICAgICAgdXBsb2FkTWV0aG9kOiAiUFVUIiwKICAgICAgICAvLyBUaGUgbWV0aG9kIHVzZWQgZm9yIHVwbG9hZGluZywgb3B0aW9ucyBhcmUgbXVsdGlwYXJ0IG9yIG9jdGV0LCBkZWZhdWx0IG11bHRpcGFydCwgcmVmZXIgdG8gbXVsdGlwYXJ0IHZzIG9jdGV0LgogICAgICAgIC8vIE1pbmlPIGNodW5raW5nIGNhbid0IHVzZSBmb3JtCiAgICAgICAgbWV0aG9kOiAib2N0ZXQiLAogICAgICAgIC8vIEhhbmRsZXMgcmVxdWVzdCBwYXJhbWV0ZXJzLCBkZWZhdWx0IGZ1bmN0aW9uIChwYXJhbXMpIHtyZXR1cm4gcGFyYW1zfSwgdXN1YWxseSB1c2VkIHRvIG1vZGlmeSBwYXJhbWV0ZXIgbmFtZXMgb3IgZGVsZXRlIHBhcmFtZXRlcnMuCiAgICAgICAgcHJvY2Vzc1BhcmFtczogZnVuY3Rpb24ocGFyYW1zKSB7CiAgICAgICAgICByZXR1cm4ge307CiAgICAgICAgfQogICAgICAgIC8vIGhlYWRlcnM6IHsKICAgICAgICAvLyAgJ0NvbnRlbnQtVHlwZSc6ICdiaW5hcnkvb2N0ZXQtc3RyZWFtJwogICAgICAgIC8vIH0KICAgICAgfSwKICAgICAgYXR0cnM6IHsKICAgICAgICBhY2NlcHQ6ICIqIiAvLyBBY2NlcHRhYmxlIGZpbGUgdHlwZXMKICAgICAgfSwKICAgICAgcGFuZWxTaG93OiBmYWxzZSAvLyBXaGV0aGVyIHRoZSBmaWxlIHVwbG9hZCBwYW5lbCBpcyBzaG93bgogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyBHbG9iYWwgdXBsb2FkIGNvbXBvbmVudCB1cGxvYWRlciBpbnN0YW5jZQogICAgdXBsb2FkZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyZWZzLnVwbG9hZGVyLnVwbG9hZGVyOwogICAgfSwKICAgIC8vIEN1cnJlbnQgcGF0aAogICAgZmlsZVBhdGgoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5xdWVyeS5maWxlUGF0aCA/IHRoaXMuJHJvdXRlLnF1ZXJ5LmZpbGVQYXRoIDogIi8iOwogICAgfSwKICAgIC8vIFdoZXRoZXIgdGhlIGZpbGUgdXBsb2FkIGV2ZW50IGlzIHRyaWdnZXJlZAogICAgc3RhcnRVcGxvYWRGaWxlKCkgewogICAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUuZmlsZS5zdGFydFVwbG9hZEZpbGU7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyBUcmlnZ2VyIHRoZSBjbGljayBldmVudCBvZiB0aGUgc2VsZWN0IGZpbGUgYnV0dG9uCiAgICB0cmlnZ2VyU2VsZWN0RmlsZUNsaWNrKCkgewogICAgICB0aGlzLiRyZWZzLnVwbG9hZEJ0bi4kZWwuY2xpY2soKTsgLy8gVHJpZ2dlciB0aGUgY2xpY2sgZXZlbnQgb2YgdGhlIHNlbGVjdCBmaWxlIGJ1dHRvbgogICAgfSwKCiAgICAvLyBGaWxlIGFkZGVkIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICBoYW5kbGVGaWxlQWRkZWQoZmlsZSkgewogICAgICB0aGlzLnBhbmVsU2hvdyA9IHRydWU7IC8vIFNob3cgZmlsZSB1cGxvYWQgcGFuZWwKICAgICAgdGhpcy5jYWxjdWxhdGVGaWxlTUQ1KGZpbGUpOyAvLyBDYWxjdWxhdGUgZmlsZSBNRDUgdmFsdWUKICAgICAgLy8gQ2FsY3VsYXRlIE1ENQogICAgICAvLyBHZXQgY2h1bmsgdXBsb2FkIGxpbmsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzCiAgICAgIGNvbnN0IHJlcyA9IHRoaXMuZ2V0Q2h1bmtVcGxvYWRVcmwoZmlsZSk7CiAgICAgIGNvbnNvbGUubG9nKCJGaWxlIGFkZGVkIHRvIGNoZWNrIGlmIGNodW5rIFVSTCBpcyByZXRyaWV2ZWQiKTsKICAgICAgY29uc29sZS5sb2coZmlsZS5jaHVua1VybERhdGEpOwogICAgfSwKICAgIGFzeW5jIGdldENodW5rVXBsb2FkVXJsKGZpbGUpIHsKICAgICAgLy8gUmVxdWVzdGluZyB0aGUgc2VydmVyIGZvciBlYWNoIGNodW5rJ3MgdXBsb2FkIGxpbmsKICAgICAgY29uc29sZS5sb2coZmlsZSk7CiAgICAgIGNvbnNvbGUubG9nKCJSZXRyaWV2aW5nIGNodW5rIHVwbG9hZCBsaW5rIik7CiAgICAgIGNvbnN0IGZpbGVOYW1lID0gZmlsZS5uYW1lOyAvLyBGaWxlIG5hbWUKICAgICAgY29uc3QgZmlsZVNpemUgPSBmaWxlLnNpemU7IC8vIEZpbGUgc2l6ZQogICAgICBjb25zdCBjaHVua1NpemUgPSBmaWxlLmNodW5rcy5sZW5ndGg7IC8vIE51bWJlciBvZiBjaHVua3MKICAgICAgLy8gUmVxdWVzdCBiYWNrZW5kIHRvIHJldHVybiB1cGxvYWQgbGluayBmb3IgZWFjaCBjaHVuawogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0VXBGaWxlKHsKICAgICAgICBmaWxlbmFtZTogZmlsZU5hbWUsCiAgICAgICAgY2h1bmtOdW1iZXI6IGNodW5rU2l6ZSwKICAgICAgICBmaWxlUGF0aDogdGhpcy5maWxlUGF0aCwKICAgICAgICB1cGxvYWRUaW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICBmaWxlU2l6ZTogZmlsZVNpemUsCiAgICAgICAgaWRlbnRpZmllcjogZmlsZS51bmlxdWVJZGVudGlmaWVyCiAgICAgIH0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXRyaWV2ZWQgdXBsb2FkSWQ6IiArIHJlc3BvbnNlLnVwbG9hZElkKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXRyaWV2ZWQgY2h1bmsgdXBsb2FkIGxpbmsgY29sbGVjdGlvbjoiKTsKICAgICAgICAgIGZpbGUuY2h1bmtVcmxEYXRhID0gcmVzcG9uc2U7CiAgICAgICAgICBjb25zb2xlLmxvZyhmaWxlLmNodW5rVXJsRGF0YSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvKioKICAgICAqIEZpbGUgdXBsb2FkIHByb2Nlc3MgY2FsbGJhY2sgZnVuY3Rpb24KICAgICAqIEBwYXJhbSByb290RmlsZSBUaGUgcm9vdCBVcGxvYWRlci5GaWxlIG9iamVjdCBvZiB0aGUgc3VjY2Vzc2Z1bGx5IHVwbG9hZGVkIGZpbGUsIHdoaWNoIHNob3VsZCBjb250YWluIG9yIGVxdWFsIHRoZSBzdWNjZXNzZnVsbHkgdXBsb2FkZWQgZmlsZQogICAgICogQHBhcmFtIGZpbGUgVGhlIGN1cnJlbnQgc3VjY2Vzc2Z1bCBVcGxvYWRlci5GaWxlIG9iamVjdCBpdHNlbGYKICAgICAqIEBwYXJhbSBjaHVuayBUaGUgVXBsb2FkZXIuQ2h1bmsgaW5zdGFuY2UsIHdoaWNoIGlzIHRoZSBsYXN0IGNodW5rIGluc3RhbmNlIG9mIHRoZSBmaWxlLCBpZiB5b3Ugd2FudCB0byBnZXQgdGhlIHJlc3BvbnNlIGNvZGUsIGNodW5rLnhoci5zdGF0dXMgaXMgaXQKICAgICAqLwogICAgb25GaWxlUHJvZ3Jlc3Mocm9vdEZpbGUsIGZpbGUsIGNodW5rKSB7CiAgICAgIC8vIFByaW50IGluZm9ybWF0aW9uIGR1cmluZyBmaWxlIHVwbG9hZAogICAgICBjb25zb2xlLmxvZygKICAgICAgICBgVXBsb2FkaW5nICR7ZmlsZS5uYW1lfSwgY2h1bms6ICR7Y2h1bmsuc3RhcnRCeXRlIC8KICAgICAgICAxMDI0IC8KICAgICAgICAxMDI0fSB+ICR7Y2h1bmsuZW5kQnl0ZSAvIDEwMjQgLyAxMDI0fWAKICAgICAgKTsKICAgIH0sCiAgICAvKioKICAgICAqIEZpbGUgdXBsb2FkIHN1Y2Nlc3MgY2FsbGJhY2sgZnVuY3Rpb24KICAgICAqIEBwYXJhbSByb290RmlsZQogICAgICogQHBhcmFtIGZpbGUKICAgICAqLwogICAgaGFuZGxlRmlsZVN1Y2Nlc3Mocm9vdEZpbGUsIGZpbGUpIHsKICAgICAgY29uc29sZS5sb2coIlNpbmdsZSBmaWxlIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseSIsIGFyZ3VtZW50cyk7CiAgICAgIC8vIENhbGwgYmFja2VuZCB0byBtZXJnZSBmaWxlcwogICAgICBjb25zdCBmaWxlTmFtZSA9IGZpbGUubmFtZTsgLy8gRmlsZSBuYW1lCiAgICAgIGNvbnN0IHVwbG9hZElkID0gZmlsZS5jaHVua1VybERhdGEudXBsb2FkSWQ7IC8vIHVwbG9hZElkCiAgICAgIGNvbnNvbGUubG9nKCk7CiAgICAgIGdldE11bHRpcGFydFVwbG9hZCh7CiAgICAgICAgRmlsZU5hbWU6IGZpbGVOYW1lLAogICAgICAgIHVwbG9hZElkOiB1cGxvYWRJZAogICAgICB9KQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTsKICAgICAgICB9KTsKICAgICAgdGhpcy4kZW1pdCgiZ2V0VGFibGVEYXRhIik7CiAgICAgIGNvbnNvbGUubG9nKCJNZXJnZSBjb21wbGV0ZSIpOwogICAgfSwKCiAgICAvLyBGaWxlIHVwbG9hZCBmYWlsdXJlIGNhbGxiYWNrIGZ1bmN0aW9uCiAgICBoYW5kbGVGaWxlRXJyb3Iocm9vdEZpbGUsIGZpbGUsIHJlc3BvbnNlU3RyKSB7CiAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgIG1lc3NhZ2U6IEpTT04ucGFyc2UocmVzcG9uc2VTdHIpLm1lc3NhZ2UsCiAgICAgICAgdHlwZTogImVycm9yIgogICAgICB9KTsKICAgIH0sCgogICAgLy8gQ2FsY3VsYXRlIGZpbGUgTUQ1IHZhbHVlCiAgICBjYWxjdWxhdGVGaWxlTUQ1KGZpbGUpIHsKICAgICAgbGV0IGZpbGVSZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICBsZXQgYmxvYlNsaWNlID0KICAgICAgICBGaWxlLnByb3RvdHlwZS5zbGljZSB8fAogICAgICAgIEZpbGUucHJvdG90eXBlLm1velNsaWNlIHx8CiAgICAgICAgRmlsZS5wcm90b3R5cGUud2Via2l0U2xpY2U7CiAgICAgIGxldCBjdXJyZW50Q2h1bmsgPSAwOwogICAgICBjb25zdCBjaHVua1NpemUgPSA1ICogMTAyNCAqIDEwMjQ7CiAgICAgIGxldCBjaHVua3MgPSBNYXRoLmNlaWwoZmlsZS5zaXplIC8gY2h1bmtTaXplKTsKICAgICAgbGV0IHNwYXJrID0gbmV3IFNwYXJrTUQ1LkFycmF5QnVmZmVyKCk7CiAgICAgIGZpbGUucGF1c2UoKTsgLy8gUGF1c2UgZmlsZSB1cGxvYWQKICAgICAgbG9hZE5leHQoKTsKICAgICAgZmlsZVJlYWRlci5vbmxvYWQgPSBlID0+IHsKICAgICAgICBzcGFyay5hcHBlbmQoZS50YXJnZXQucmVzdWx0KTsKICAgICAgICBpZiAoY3VycmVudENodW5rIDwgY2h1bmtzKSB7CiAgICAgICAgICBjdXJyZW50Q2h1bmsrKzsKICAgICAgICAgIGxvYWROZXh0KCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGxldCBtZDUgPSBzcGFyay5lbmQoKTsKICAgICAgICAgIHRoaXMuY2FsY3VsYXRlRmlsZU1ENUVuZChtZDUsIGZpbGUpOwogICAgICAgICAgLy8gY29uc29sZS5sb2coCiAgICAgICAgICAvLyAgIGBNRDUgY2FsY3VsYXRpb24gY29tcGxldGU6ICR7ZmlsZS5uYW1lfSBcbk1ENTogJHttZDV9IFxuQ2h1bmtzOiAke2NodW5rc30gU2l6ZTogJHsKICAgICAgICAgIC8vICAgICBmaWxlLnNpemUKICAgICAgICAgIC8vICAgfSBUaW1lOiAke25ldyBEYXRlKCkuZ2V0VGltZSgpIC0gdGltZX0gbXNgCiAgICAgICAgICAvLyApOwogICAgICAgIH0KICAgICAgfTsKICAgICAgZmlsZVJlYWRlci5vbmVycm9yID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAgIHRpdGxlOiAiVXBsb2FkIGVycm9yIiwKICAgICAgICAgIG1lc3NhZ2U6IGBGaWxlICR7ZmlsZS5uYW1lfSByZWFkIGVycm9yLCBwbGVhc2UgY2hlY2sgdGhlIGZpbGVgLAogICAgICAgICAgdHlwZTogImVycm9yIiwKICAgICAgICAgIGR1cmF0aW9uOiAyMDAwCiAgICAgICAgfSk7CiAgICAgICAgZmlsZS5jYW5jZWwoKTsgLy8gQ2FuY2VsIHVwbG9hZCBhbmQgcmVtb3ZlIGZyb20gZmlsZSBsaXN0LgogICAgICB9OwoKICAgICAgZnVuY3Rpb24gbG9hZE5leHQoKSB7CiAgICAgICAgbGV0IHN0YXJ0ID0gY3VycmVudENodW5rICogY2h1bmtTaXplOwogICAgICAgIGxldCBlbmQgPQogICAgICAgICAgc3RhcnQgKyBjaHVua1NpemUgPj0gZmlsZS5zaXplID8gZmlsZS5zaXplIDogc3RhcnQgKyBjaHVua1NpemU7CiAgICAgICAgZmlsZVJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iU2xpY2UuY2FsbChmaWxlLmZpbGUsIHN0YXJ0LCBlbmQpKTsKICAgICAgfQogICAgfSwKICAgIC8vIEZpbGUgTUQ1IGNhbGN1bGF0aW9uIGNvbXBsZXRlCiAgICBjYWxjdWxhdGVGaWxlTUQ1RW5kKG1kNSwgZmlsZSkgewogICAgICBmaWxlLnVuaXF1ZUlkZW50aWZpZXIgPSBtZDU7CiAgICAgIGZpbGUucmVzdW1lKCk7IC8vIENvbnRpbnVlIGZpbGUgdXBsb2FkCiAgICB9LAoKICAgIC8vIENsb3NlIHVwbG9hZCBwYW5lbAogICAgaGFuZGxlQ2xvc2VQYW5lbCgpIHsKICAgICAgdGhpcy51cGxvYWRlci5jYW5jZWwoKTsgLy8gQ2FuY2VsIGZpbGUgdXBsb2FkCiAgICAgIHRoaXMucGFuZWxTaG93ID0gZmFsc2U7CgogICAgICB0aGlzLiRlbWl0KCJnZXRUYWJsZURhdGEiKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["FileUploader.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"FileUploader.vue","sourceRoot":"src/views/components","sourcesContent":["<template>\n  <div id=\"global-uploader\">\n    <!-- Upload component -->\n    <uploader\n      class=\"uploader-box\"\n      ref=\"uploader\"\n      :options=\"options\"\n      :autoStart=\"false\"\n      @file-added=\"handleFileAdded\"\n      @file-progress=\"onFileProgress\"\n      @file-success=\"handleFileSuccess\"\n      @file-error=\"handleFileError\"\n    >\n      <uploader-unsupport></uploader-unsupport>\n      <!-- Select file button -->\n      <uploader-btn class=\"select-file-btn\" :attrs=\"attrs\" ref=\"uploadBtn\"\n      >Select File\n      </uploader-btn\n      >\n      <!-- Panel for files being uploaded -->\n      <uploader-list v-show=\"panelShow\">\n        <div class=\"file-panel\" slot-scope=\"props\">\n          <div class=\"panel-title\">\n            <span class=\"text\">Upload List</span>\n\n            <div class=\"operate-btn-wrapper\">\n              <el-button\n                type=\"text\"\n                title=\"Close Window\"\n                icon=\"el-icon-close\"\n                @click=\"handleClosePanel\"\n              >\n              </el-button>\n            </div>\n          </div>\n          <!-- List of files being uploaded -->\n          <ul class=\"file-list\">\n            <li class=\"file-item\" v-for=\"file in props.fileList\" :key=\"file.id\">\n              <uploader-file\n                ref=\"files\"\n                :class=\"`file_${file.id}`\"\n                :file=\"file\"\n                :list=\"true\"\n              ></uploader-file>\n            </li>\n            <div class=\"no-file\" v-if=\"!props.fileList.length\">\n              <i class=\"icon-empty-file\"></i> No files waiting to be uploaded\n            </div>\n          </ul>\n        </div>\n      </uploader-list>\n    </uploader>\n  </div>\n</template>\n\n\n<script>\nimport SparkMD5 from \"spark-md5\";\nimport { getMultipartUpload, getUpFile } from \"@/request/file\";\n\nexport default {\n  name: \"FileUploader\",\n  data() {\n    return {\n      options: {\n        // The target upload URL, which can be a string or a function. If it's a function, it will be passed with Uploader.File instance,\n        // current chunk Uploader.Chunk, and whether it is in test mode. The default value is '/'.\n        target: function(file, chunkFile, mode) {\n          // Entering this method before each chunk upload\n          console.log(\"Entering target\");\n          console.log(\"File name: \" + file.name);\n          console.log(\"Current chunk sequence number: \" + chunkFile.offset);\n          console.log(\"Retrieved chunk upload URL:\");\n          console.log(file.chunkUrlData);\n          const key = \"chunk_\" + chunkFile.offset; // Key for retrieving chunk link URL\n          return file.chunkUrlData[key];\n        },\n        // Sends a GET request to the server for each chunk to check if it already exists. If implemented on the server side,\n        // this will allow continuing uploads after a browser crash or even computer restart. (Default: true)\n        testChunks: true,\n        // Chunks are divided according to this value. The size of the last chunk will be greater than or equal to this value, but less than twice this value.\n        // See this Issue #51, default 1*1024*1024.\n        chunkSize: 5 * 1024 * 1024,\n        // Forces all chunks to be less than or equal to chunkSize. Otherwise, the last chunk will be greater than or equal to chunkSize. (Default: false)\n        forceChunkSize: true,\n        // Additional parameters included in multipart POST with data. This can be an object or a function. If it is a function,\n        // it will be passed an Uploader.File, an Uploader.Chunk object, and an isTest boolean value (default value {}：)\n        query: function(file, chunkFile, mode) {\n          const data = { partNumber: chunkFile.offset + 1 };\n          return data;\n        },\n        uploadMethod: \"PUT\",\n        // The method used for uploading, options are multipart or octet, default multipart, refer to multipart vs octet.\n        // MiniO chunking can't use form\n        method: \"octet\",\n        // Handles request parameters, default function (params) {return params}, usually used to modify parameter names or delete parameters.\n        processParams: function(params) {\n          return {};\n        }\n        // headers: {\n        //  'Content-Type': 'binary/octet-stream'\n        // }\n      },\n      attrs: {\n        accept: \"*\" // Acceptable file types\n      },\n      panelShow: false // Whether the file upload panel is shown\n    };\n  },\n  computed: {\n    // Global upload component uploader instance\n    uploader() {\n      return this.$refs.uploader.uploader;\n    },\n    // Current path\n    filePath() {\n      return this.$route.query.filePath ? this.$route.query.filePath : \"/\";\n    },\n    // Whether the file upload event is triggered\n    startUploadFile() {\n      return this.$store.state.file.startUploadFile;\n    }\n  },\n  methods: {\n    // Trigger the click event of the select file button\n    triggerSelectFileClick() {\n      this.$refs.uploadBtn.$el.click(); // Trigger the click event of the select file button\n    },\n\n    // File added callback function\n    handleFileAdded(file) {\n      this.panelShow = true; // Show file upload panel\n      this.calculateFileMD5(file); // Calculate file MD5 value\n      // Calculate MD5\n      // Get chunk upload link\n      // eslint-disable-next-line no-unused-vars\n      const res = this.getChunkUploadUrl(file);\n      console.log(\"File added to check if chunk URL is retrieved\");\n      console.log(file.chunkUrlData);\n    },\n    async getChunkUploadUrl(file) {\n      // Requesting the server for each chunk's upload link\n      console.log(file);\n      console.log(\"Retrieving chunk upload link\");\n      const fileName = file.name; // File name\n      const fileSize = file.size; // File size\n      const chunkSize = file.chunks.length; // Number of chunks\n      // Request backend to return upload link for each chunk\n      // eslint-disable-next-line no-unused-vars\n      const res = await getUpFile({\n        filename: fileName,\n        chunkNumber: chunkSize,\n        filePath: this.filePath,\n        uploadTime: new Date().getTime(),\n        fileSize: fileSize,\n        identifier: file.uniqueIdentifier\n      })\n        .then(function(response) {\n          console.log(\"Retrieved uploadId:\" + response.uploadId);\n          console.log(\"Retrieved chunk upload link collection:\");\n          file.chunkUrlData = response;\n          console.log(file.chunkUrlData);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n    },\n    /**\n     * File upload process callback function\n     * @param rootFile The root Uploader.File object of the successfully uploaded file, which should contain or equal the successfully uploaded file\n     * @param file The current successful Uploader.File object itself\n     * @param chunk The Uploader.Chunk instance, which is the last chunk instance of the file, if you want to get the response code, chunk.xhr.status is it\n     */\n    onFileProgress(rootFile, file, chunk) {\n      // Print information during file upload\n      console.log(\n        `Uploading ${file.name}, chunk: ${chunk.startByte /\n        1024 /\n        1024} ~ ${chunk.endByte / 1024 / 1024}`\n      );\n    },\n    /**\n     * File upload success callback function\n     * @param rootFile\n     * @param file\n     */\n    handleFileSuccess(rootFile, file) {\n      console.log(\"Single file uploaded successfully\", arguments);\n      // Call backend to merge files\n      const fileName = file.name; // File name\n      const uploadId = file.chunkUrlData.uploadId; // uploadId\n      console.log();\n      getMultipartUpload({\n        FileName: fileName,\n        uploadId: uploadId\n      })\n        .then(function(response) {\n          console.log(response);\n        })\n        .catch(function(error) {\n          console.log(error);\n        });\n      this.$emit(\"getTableData\");\n      console.log(\"Merge complete\");\n    },\n\n    // File upload failure callback function\n    handleFileError(rootFile, file, responseStr) {\n      this.$message({\n        message: JSON.parse(responseStr).message,\n        type: \"error\"\n      });\n    },\n\n    // Calculate file MD5 value\n    calculateFileMD5(file) {\n      let fileReader = new FileReader();\n      let blobSlice =\n        File.prototype.slice ||\n        File.prototype.mozSlice ||\n        File.prototype.webkitSlice;\n      let currentChunk = 0;\n      const chunkSize = 5 * 1024 * 1024;\n      let chunks = Math.ceil(file.size / chunkSize);\n      let spark = new SparkMD5.ArrayBuffer();\n      file.pause(); // Pause file upload\n      loadNext();\n      fileReader.onload = e => {\n        spark.append(e.target.result);\n        if (currentChunk < chunks) {\n          currentChunk++;\n          loadNext();\n        } else {\n          let md5 = spark.end();\n          this.calculateFileMD5End(md5, file);\n          // console.log(\n          //   `MD5 calculation complete: ${file.name} \\nMD5: ${md5} \\nChunks: ${chunks} Size: ${\n          //     file.size\n          //   } Time: ${new Date().getTime() - time} ms`\n          // );\n        }\n      };\n      fileReader.onerror = function() {\n        this.$notify({\n          title: \"Upload error\",\n          message: `File ${file.name} read error, please check the file`,\n          type: \"error\",\n          duration: 2000\n        });\n        file.cancel(); // Cancel upload and remove from file list.\n      };\n\n      function loadNext() {\n        let start = currentChunk * chunkSize;\n        let end =\n          start + chunkSize >= file.size ? file.size : start + chunkSize;\n        fileReader.readAsArrayBuffer(blobSlice.call(file.file, start, end));\n      }\n    },\n    // File MD5 calculation complete\n    calculateFileMD5End(md5, file) {\n      file.uniqueIdentifier = md5;\n      file.resume(); // Continue file upload\n    },\n\n    // Close upload panel\n    handleClosePanel() {\n      this.uploader.cancel(); // Cancel file upload\n      this.panelShow = false;\n\n      this.$emit(\"getTableData\");\n    }\n  }\n};\n</script>\n\n\n<style lang=\"stylus\" scoped>\n#global-uploader {\n  position: fixed;\n  z-index: 20;\n  right: 15px;\n  bottom: 15px;\n\n  .uploader-box {\n    width: 520px;\n  }\n\n  .file-panel {\n    background-color: #fff;\n    border: 1px solid #e2e2e2;\n    border-radius: 7px 7px 0 0;\n    box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);\n\n    .panel-title {\n      display: flex;\n      height: 40px;\n      line-height: 40px;\n      padding: 0 16px;\n      border-bottom: 1px solid #ddd;\n\n      .text {\n        padding-left: 0;\n        margin-bottom: 0;\n        font-size: 16px;\n        color: #303133;\n      }\n\n      .operate-btn-wrapper {\n        flex: 1;\n        text-align: right;\n\n        >>> .el-button {\n          *:hover {\n            opacity: 0.5;\n          }\n\n          i[class^=el-icon-] {\n            color: #000;\n          }\n        }\n      }\n    }\n\n    .file-list {\n      position: relative;\n      height: 240px;\n      overflow-x: hidden;\n      overflow-y: auto;\n      background-color: #fff;\n      font-size: 14px;\n\n      .file-item {\n        background-color: #fff;\n\n        >>> .uploader-file-icon {\n          display: none;\n        }\n      }\n    }\n  }\n\n  .no-file {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    font-size: 16px;\n  }\n\n  /deep/.uploader-file-actions > span {\n    margin-right: 6px;\n  }\n}\n\n/* 隐藏上传按钮 */\n.select-file-btn {\n  display: none;\n}\n</style>\n"]}]}